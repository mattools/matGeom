<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of drawEllipsoid</title>
  <meta name="keywords" content="drawEllipsoid">
  <meta name="description" content="DRAWELLIPSOID Draw a 3D ellipsoid.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003-2019 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">matGeom</a> &gt; <a href="index.html">geom3d</a> &gt; drawEllipsoid.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for matGeom\geom3d&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>drawEllipsoid
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>DRAWELLIPSOID Draw a 3D ellipsoid.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function varargout = drawEllipsoid(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">DRAWELLIPSOID Draw a 3D ellipsoid.

   drawEllipsoid(ELLI)
   Displays a 3D ellipsoid on current axis. ELLI is given by:
   [XC YC ZC A B C PHI THETA PSI],
   where (XC, YC, ZC) is the ellipsoid center, A, B and C are the half
   lengths of the ellipsoid main axes, and PHI THETA PSI are Euler angles
   representing ellipsoid orientation, in degrees (type 'help angles3d'
   for more details).

   drawEllipsoid(..., 'drawEllipses', true)
   Also displays the main 3D ellipses corresponding to XY, XZ and YZ
   planes.


   Example
     figure; hold on;
     drawEllipsoid([10 20 30   50 30 10   5 10 0]);
     axis equal;

     figure; hold on;
     elli = [10 20 30   50 30 10   5 10 0];
     drawEllipsoid(elli, 'FaceColor', 'r', ...
         'drawEllipses', true, 'EllipseColor', 'b', 'EllipseWidth', 3);
     axis equal;

   See also
   <a href="spheres.html" class="code" title="function spheres(varargin)">spheres</a>, <a href="equivalentEllipsoid.html" class="code" title="function ell = equivalentEllipsoid(points)">equivalentEllipsoid</a>, ellipsoid, <a href="angles3d.html" class="code" title="function angles3d(varargin)">angles3d</a>
   <a href="drawSphere.html" class="code" title="function varargout = drawSphere(varargin)">drawSphere</a>, <a href="drawCuboid.html" class="code" title="function varargout = drawCuboid(varargin)">drawCuboid</a>, <a href="drawTorus.html" class="code" title="function varargout = drawTorus(varargin)">drawTorus</a>, <a href="drawCylinder.html" class="code" title="function varargout = drawCylinder(varargin)">drawCylinder</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="createRotationOx.html" class="code" title="function trans = createRotationOx(varargin)">createRotationOx</a>	CREATEROTATIONOX Create the 4x4 matrix of a 3D rotation around x-axis.</li><li><a href="createRotationOy.html" class="code" title="function trans = createRotationOy(varargin)">createRotationOy</a>	CREATEROTATIONOY Create the 4x4 matrix of a 3D rotation around y-axis.</li><li><a href="createRotationOz.html" class="code" title="function trans = createRotationOz(varargin)">createRotationOz</a>	CREATEROTATIONOZ Create the 4x4 matrix of a 3D rotation around z-axis.</li><li><a href="createScaling3d.html" class="code" title="function trans = createScaling3d(varargin)">createScaling3d</a>	CREATESCALING3D Create the 4x4 matrix of a 3D scaling.</li><li><a href="createTranslation3d.html" class="code" title="function trans = createTranslation3d(varargin)">createTranslation3d</a>	CREATETRANSLATION3D Create the 4x4 matrix of a 3D translation.</li><li><a href="drawEdge3d.html" class="code" title="function varargout = drawEdge3d(varargin)">drawEdge3d</a>	DRAWEDGE3D Draw 3D edge in the current axes.</li><li><a href="transformPoint3d.html" class="code" title="function varargout = transformPoint3d(pts, transfo, varargin)">transformPoint3d</a>	TRANSFORMPOINT3D Transform a point with a 3D affine transform.</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = drawEllipsoid(varargin)</a>
0002 <span class="comment">%DRAWELLIPSOID Draw a 3D ellipsoid.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">%   drawEllipsoid(ELLI)</span>
0005 <span class="comment">%   Displays a 3D ellipsoid on current axis. ELLI is given by:</span>
0006 <span class="comment">%   [XC YC ZC A B C PHI THETA PSI],</span>
0007 <span class="comment">%   where (XC, YC, ZC) is the ellipsoid center, A, B and C are the half</span>
0008 <span class="comment">%   lengths of the ellipsoid main axes, and PHI THETA PSI are Euler angles</span>
0009 <span class="comment">%   representing ellipsoid orientation, in degrees (type 'help angles3d'</span>
0010 <span class="comment">%   for more details).</span>
0011 <span class="comment">%</span>
0012 <span class="comment">%   drawEllipsoid(..., 'drawEllipses', true)</span>
0013 <span class="comment">%   Also displays the main 3D ellipses corresponding to XY, XZ and YZ</span>
0014 <span class="comment">%   planes.</span>
0015 <span class="comment">%</span>
0016 <span class="comment">%</span>
0017 <span class="comment">%   Example</span>
0018 <span class="comment">%     figure; hold on;</span>
0019 <span class="comment">%     drawEllipsoid([10 20 30   50 30 10   5 10 0]);</span>
0020 <span class="comment">%     axis equal;</span>
0021 <span class="comment">%</span>
0022 <span class="comment">%     figure; hold on;</span>
0023 <span class="comment">%     elli = [10 20 30   50 30 10   5 10 0];</span>
0024 <span class="comment">%     drawEllipsoid(elli, 'FaceColor', 'r', ...</span>
0025 <span class="comment">%         'drawEllipses', true, 'EllipseColor', 'b', 'EllipseWidth', 3);</span>
0026 <span class="comment">%     axis equal;</span>
0027 <span class="comment">%</span>
0028 <span class="comment">%   See also</span>
0029 <span class="comment">%   spheres, equivalentEllipsoid, ellipsoid, angles3d</span>
0030 <span class="comment">%   drawSphere, drawCuboid, drawTorus, drawCylinder</span>
0031 <span class="comment">%</span>
0032 
0033 <span class="comment">% ------</span>
0034 <span class="comment">% Author: David Legland</span>
0035 <span class="comment">% E-mail: david.legland@inrae.fr</span>
0036 <span class="comment">% Created: 2011-03-12, using Matlab 7.9.0.529 (R2009b)</span>
0037 <span class="comment">% Copyright 2011-2024 INRA - Cepia Software Platform</span>
0038 
0039 <span class="comment">%% Default values</span>
0040 
0041 <span class="comment">% number of meridians</span>
0042 nPhi    = 32;
0043 
0044 <span class="comment">% number of parallels</span>
0045 nTheta  = 16;
0046 
0047 <span class="comment">% settings for drawing ellipses</span>
0048 drawEllipses = false;
0049 ellipseColor = <span class="string">'k'</span>;
0050 ellipseWidth = 1;
0051 
0052 drawAxes = false;
0053 axesColor = <span class="string">'k'</span>;
0054 axesWidth = 2;
0055 
0056 
0057 <span class="comment">%% Extract input arguments</span>
0058 
0059 <span class="comment">% extract handle of axis to draw on</span>
0060 [hAx, varargin] = parseAxisHandle(varargin{:});
0061 
0062 <span class="comment">% retrieve parameters of ellipsoid</span>
0063 elli = varargin{1};
0064 varargin(1) = [];
0065 
0066 <span class="comment">% default set of options for drawing meshes</span>
0067 options = {<span class="string">'FaceColor'</span>, <span class="string">'g'</span>, <span class="string">'linestyle'</span>, <span class="string">'none'</span>};
0068 
0069 <span class="keyword">while</span> length(varargin) &gt; 1
0070     <span class="keyword">switch</span> lower(varargin{1})
0071         <span class="keyword">case</span> <span class="string">'nphi'</span>
0072             nPhi = varargin{2};
0073             
0074         <span class="keyword">case</span> <span class="string">'ntheta'</span>
0075             nTheta = varargin{2};
0076 
0077         <span class="keyword">case</span> <span class="string">'drawellipses'</span>
0078             drawEllipses = varargin{2};
0079             
0080         <span class="keyword">case</span> <span class="string">'ellipsecolor'</span>
0081             ellipseColor = varargin{2};
0082             
0083         <span class="keyword">case</span> <span class="string">'ellipsewidth'</span>
0084             ellipseWidth = varargin{2};
0085             
0086         <span class="keyword">case</span> <span class="string">'drawaxes'</span>
0087             drawAxes = varargin{2};
0088             
0089         <span class="keyword">case</span> <span class="string">'axescolor'</span>
0090             axesColor = varargin{2};
0091             
0092         <span class="keyword">case</span> <span class="string">'axeswidth'</span>
0093             axesWidth = varargin{2};
0094             
0095         <span class="keyword">otherwise</span>
0096             <span class="comment">% assumes this is drawing option</span>
0097             options = [options varargin(1:2)]; <span class="comment">%#ok&lt;AGROW&gt;</span>
0098     <span class="keyword">end</span>
0099 
0100     varargin(1:2) = [];
0101 <span class="keyword">end</span>
0102 
0103 
0104 <span class="comment">%% Parse numerical inputs</span>
0105 
0106 <span class="comment">% Extract ellipsoid parameters</span>
0107 xc  = elli(:,1);
0108 yc  = elli(:,2);
0109 zc  = elli(:,3);
0110 a   = elli(:,4);
0111 b   = elli(:,5);
0112 c   = elli(:,6);
0113 k   = pi / 180;
0114 ellPhi   = elli(:,7) * k;
0115 ellTheta = elli(:,8) * k;
0116 ellPsi   = elli(:,9) * k;
0117 
0118 
0119 <span class="comment">%% Coordinates computation</span>
0120 
0121 <span class="comment">% convert unit basis to ellipsoid basis</span>
0122 sca     = <a href="createScaling3d.html" class="code" title="function trans = createScaling3d(varargin)">createScaling3d</a>(a, b, c);
0123 rotZ    = <a href="createRotationOz.html" class="code" title="function trans = createRotationOz(varargin)">createRotationOz</a>(ellPhi);
0124 rotY    = <a href="createRotationOy.html" class="code" title="function trans = createRotationOy(varargin)">createRotationOy</a>(ellTheta);
0125 rotX    = <a href="createRotationOx.html" class="code" title="function trans = createRotationOx(varargin)">createRotationOx</a>(ellPsi);
0126 tra     = <a href="createTranslation3d.html" class="code" title="function trans = createTranslation3d(varargin)">createTranslation3d</a>([xc yc zc]);
0127 
0128 <span class="comment">% concatenate transforms</span>
0129 trans   = tra * rotZ * rotY * rotX * sca;
0130 
0131 
0132 <span class="comment">%% parametrisation of ellipsoid</span>
0133 
0134 <span class="comment">% spherical coordinates</span>
0135 theta   = linspace(0, pi, nTheta+1);
0136 phi     = linspace(0, 2*pi, nPhi+1);
0137 
0138 <span class="comment">% convert to cartesian coordinates</span>
0139 sintheta = sin(theta);
0140 x = cos(phi') * sintheta;
0141 y = sin(phi') * sintheta;
0142 z = ones(length(phi),1) * cos(theta);
0143 
0144 <span class="comment">% transform mesh vertices</span>
0145 [x, y, z] = <a href="transformPoint3d.html" class="code" title="function varargout = transformPoint3d(pts, transfo, varargin)">transformPoint3d</a>(x, y, z, trans);
0146 
0147 
0148 <span class="comment">%% parametrisation of ellipses</span>
0149 
0150 <span class="keyword">if</span> drawEllipses
0151     <span class="comment">% parametrisation for ellipses</span>
0152     nVertices = 120;
0153     t = linspace(0, 2*pi, nVertices+1);
0154 
0155     <span class="comment">% XY circle</span>
0156     xc1 = cos(t');
0157     yc1 = sin(t');
0158     zc1 = zeros(size(t'));
0159 
0160     <span class="comment">% XZ circle</span>
0161     xc2 = cos(t');
0162     yc2 = zeros(size(t'));
0163     zc2 = sin(t');
0164 
0165     <span class="comment">% YZ circle</span>
0166     xc3 = zeros(size(t'));
0167     yc3 = cos(t');
0168     zc3 = sin(t');
0169 
0170     <span class="comment">% compute transformed ellipses</span>
0171     [xc1, yc1, zc1] = <a href="transformPoint3d.html" class="code" title="function varargout = transformPoint3d(pts, transfo, varargin)">transformPoint3d</a>(xc1, yc1, zc1, trans);
0172     [xc2, yc2, zc2] = <a href="transformPoint3d.html" class="code" title="function varargout = transformPoint3d(pts, transfo, varargin)">transformPoint3d</a>(xc2, yc2, zc2, trans);
0173     [xc3, yc3, zc3] = <a href="transformPoint3d.html" class="code" title="function varargout = transformPoint3d(pts, transfo, varargin)">transformPoint3d</a>(xc3, yc3, zc3, trans);
0174 <span class="keyword">end</span>
0175 
0176 <span class="comment">%% parametrisation of main axis edges</span>
0177 
0178 <span class="keyword">if</span> drawAxes
0179     axesEndings = [-1 0 0; +1 0 0; 0 -1 0; 0 +1 0; 0 0 -1; 0 0 +1];
0180     axesEndings = <a href="transformPoint3d.html" class="code" title="function varargout = transformPoint3d(pts, transfo, varargin)">transformPoint3d</a>(axesEndings, trans);
0181 <span class="keyword">end</span>
0182 
0183 
0184 <span class="comment">%% Drawing</span>
0185 
0186 ellipseOptions = {<span class="string">'color'</span>, ellipseColor, <span class="string">'LineWidth'</span>, ellipseWidth};
0187 axesOptions = {<span class="string">'color'</span>, axesColor, <span class="string">'LineWidth'</span>, axesWidth};
0188 
0189 <span class="comment">% Process output</span>
0190 <span class="keyword">if</span> nargout == 0
0191     <span class="comment">% no output: draw the ellipsoid</span>
0192     surf(x, y, z, options{:});
0193 
0194     <span class="keyword">if</span> drawEllipses
0195         plot3(hAx, xc1, yc1, zc1, ellipseOptions{:});
0196         plot3(hAx, xc2, yc2, zc2, ellipseOptions{:});
0197         plot3(hAx, xc3, yc3, zc3, ellipseOptions{:});
0198     <span class="keyword">end</span>
0199     
0200     <span class="keyword">if</span> drawAxes
0201         <a href="drawEdge3d.html" class="code" title="function varargout = drawEdge3d(varargin)">drawEdge3d</a>(hAx, [axesEndings(1,:), axesEndings(2,:)], axesOptions{:});
0202         <a href="drawEdge3d.html" class="code" title="function varargout = drawEdge3d(varargin)">drawEdge3d</a>(hAx, [axesEndings(3,:), axesEndings(4,:)], axesOptions{:});
0203         <a href="drawEdge3d.html" class="code" title="function varargout = drawEdge3d(varargin)">drawEdge3d</a>(hAx, [axesEndings(5,:), axesEndings(6,:)], axesOptions{:});
0204     <span class="keyword">end</span>
0205     
0206 <span class="keyword">elseif</span> nargout == 1
0207     <span class="comment">% one output: draw the ellipsoid and return handle</span>
0208     varargout{1} = surf(x, y, z, options{:});
0209     <span class="keyword">if</span> drawEllipses
0210         plot3(hAx, xc1, yc1, zc1, ellipseOptions{:});
0211         plot3(hAx, xc2, yc2, zc2, ellipseOptions{:});
0212         plot3(hAx, xc3, yc3, zc3, ellipseOptions{:});
0213     <span class="keyword">end</span>
0214     
0215 <span class="keyword">elseif</span> nargout == 3
0216     <span class="comment">% 3 outputs: return computed coordinates</span>
0217     varargout{1} = x; 
0218     varargout{2} = y; 
0219     varargout{3} = z; 
0220     <span class="keyword">if</span> drawEllipses
0221         plot3(hAx, xc1, yc1, zc1, ellipseOptions{:});
0222         plot3(hAx, xc2, yc2, zc2, ellipseOptions{:});
0223         plot3(hAx, xc3, yc3, zc3, ellipseOptions{:});
0224     <span class="keyword">end</span>
0225     
0226 <span class="keyword">elseif</span> nargout == 4 &amp;&amp; drawEllipses
0227     <span class="comment">% Also returns handles to ellipses</span>
0228     varargout{1} = surf(hAx, x, y, z, options{:});
0229     varargout{2} = plot3(hAx, xc1, yc1, zc1, ellipseOptions{:});
0230     varargout{3} = plot3(hAx, xc2, yc2, zc2, ellipseOptions{:});
0231     varargout{4} = plot3(hAx, xc3, yc3, zc3, ellipseOptions{:});
0232     
0233 <span class="keyword">end</span>
0234</pre></div>
<hr><address>Generated on Thu 21-Nov-2024 11:30:22 by <strong><a href="https://github.com/gllmflndn/m2html">m2html</a></strong> &copy; 2003-2022</address>
</body>
</html>